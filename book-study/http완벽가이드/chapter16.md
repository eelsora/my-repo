# 16. 국제화

## 16.1 국제적인 콘텐츠를 다루기 위해 필요한 HTTP 지원

HTTP메세지는 어떤 언어로된 콘텐츠든, 이미지, 동영상 등처럼 미디어처럼 실어 나를 수있다.

HTTP에서 엔터티 본문이란 그저 비트들로 가득 찬 상자에 불과하다.

국제 콘텐츠를 제공하기 위해 서버는 클라이언트에게 HTTP Content Type chartset 매개변수와 Content-Language 헤더를 통해 문서의 문자와 언어를 알려주어 올바를 콘텐츠를 제공할 수 있도록 한다.

```html
Accept-Language: fr, en;q=0.8 Accept-Charset: iso-8859-1, utf-8
```

## 16.2 문자집합과 HTTP

### 16.2.1 차셋(Charset)은 글자를 비트로 변환하는 인코딩이다

HTTP 차셋 값은 어떻게 엔터ㄷ티 콘텐츠 비트들을 특정 문자 체계의 글자들로 바꾸는지 알려준다.

- `Content-Type: text/html; charset=iso-8859-6`
  → 콘텐츠가 HTML 파일임을 말해주고, chartset 매개변수는 콘텐츠 비트들을 글자들로 디코딩 하기 위해 iso-8859-6 디코딩 기법을 사용하라고 말해준다.

### 16.2.2 문자집합과 인코딩은 어떻게 동작하는가

1. 인코딩 구조(iso-8859-6)를 사용하여 디코딩
2. 코딩된 문자집합을 사용하여 글자를 찾는다.
3. 글꼴과 포매팅 소프트웨어를 사용하여 화면이 보여줄 모양을 찾는다.

→ HTTP ‘문자 집합’은 문자 인코딩 구조와 코딩된 문자집합을 결합한것이다.

### 16.2.3 잘못된 차셋은 잘못된 글자들을 낳는다

만약 클라이언트가 잘못된 charset 매개변수를 사용한다면, 클라이언트는 이상한 깨진 글자를 보여주게 된다.

### 16.2.4 표준화된 MIME 차셋 값

특정 문자 인코딩과 특정 코딩된 문자집합의 결합을 MIME 차셋이라고 부른다. HTTP는 표준화된 차셋 태그를 `Content-Type` 과 `Accept-Charset` 헤더에 사용한다.

- 등록된 차셋 값들의 목록: http://www.iana.org/numbers.html

### 16.2.5 Content-Type charset 헤더와 META태그

- `Content-Type: text/html; charset=iso-2022-jp`

웹 서버는 클라이언트에게 MIME 차셋 태그를 charset 매개변수와 함께 `Content-Type` 헤더에 담아 보낸다.

만약 문자집합이 명시적으로 나열되지 않았다면 수신자는 문서 콘텐츠로부터 문자집합을 추측하려 시도한다. 만약 클라이언트가 문자 인코딩을 추측하지 못했다면 iso-8859-1인것으로 가정한다.

```html
<head>
  **
  <meta http-equiv="Conent-Type" content="text/html; charset=iso-2022-jp" />
  ** **
  <meta lang="jp" />
  ** ...
</head>
```

### 16.2.6 Accept-Charset 헤더

HTTP 클라이언트는 서버에게 Accept-Charse 헤더값을 통해 클라이언트가 지원하는 문자 인코딩의 목록을 제공한다.

`Accept-Charset: iso-8599-1, utf-8`

Accept-Charset 요청 헤더에 대응하는 Content-Charset응답헤더는 존재하지 않는다! 응답 문자 집합은 MIME과의 호환을 위해 Content-Type 응답 헤더의 charset 매개변수를 통해 서버로부터 돌려받는다.

## 16.3 다중언어 문자 인코딩에 대한 지침

### 16.3.1 문자집합 용어

- **문자:** 알파벳, 글자, 숫자, 구두점, 표의문자(중국어에서와 같은), 기호 등 글쓰기의 최소단위.
- **글리프(glyph):** 하나의 글자를 표현하기 위한, 획의 패턴이나 다른것과 구분되는 유일한 시각적 형태
- **코딩된 문자(coded character):** 우리가 글자를 다룰 수 있도록 각 글자에 할당된 유일한 숫자
- **코드공간(coding space):** 문자 코드값으로 사용하려고 계획해 둔 정수의 범위
- **코드너비(code width):** 각 문자 코드의 (고정된 크기의) 비트 개수 \*\*\*\*
- **사용 가능 문자집합(character repertoire):** 글자들에 대한 특정한 작업집합
- **코딩된 문자 집합(coded character set):** 사용 가능 문자집합을 받아서 각 글자에 코드 공간의 코드를 할당해주는 코딩된 문자들의 집합. 실제 글자들에 숫자로 된 문자 코드를 대응시킨 것이다.
- **문자 인코딩 구조:** 숫자로된 문자 코드들을 콘텐츠 비트의 연속으로 인코딩하는 알고리즘

### 16.3.2 ‘차셋(Charset)’은 형편없는 이름이다

MIME 차셋 값은 데이터 비트를 고유한 문자의 코드로 매핑하는 알고리즘의 이름이다. 이것은 문자 인코딩 구조와 코딩된 문자집합의 개념을 합친것이다.

### 16.3.3 문자

문자는 쓰기의 기본적인 구성요소이다. 하나의 문자는 하나의 알파벳 글자, 숫자, 구두점, 표의문자 등 다른 쓰기의 기본 단위를 표현한다.

### 16.3.4 글리프(glyphs), 연자(ligatures) 그리고 표현 형태

글리프와 문자를 헷갈려서는 안된다. 문잦는 유일하고 추상화된 언어 요소이고 그리프는 각 글자를 그리는 특정한 방법이다. 각 문자는 미적인 양식과 스크립트에 따라 여러가지 글리프를 가진다.

### 16.3.5 코딩된 문자 집합(Coded Character Set)

- US-ASCII: 모든 문자 집합의 어머니
- iso-8859: US-ASCII의 8비트 확대 집합들
- JIS X 0201: 아스키를 일본어 가타카나 반각문자를 더해 확장한 극단적으로 작은 문자집합
- JIS X 0208과 JIS X 0212
  - JIS X 0208: 최초의 멀티바이트 일본어 문자집합. 대부분이 일본식 한자인 6879개의 코딩된 문자를 정의함.
  - JIS X 0212는 6607개 문자 추가
    - UCS: 국제 문자세트(Universal Character Set)전 세계의 모든 글자를 코딩된 문자집합으로 통합하려 노력하는 세계적인 표준

### 16.3.6 문자 인코딩 구조

- 고정폭: 각 코딩된 문자를 고정된 길의의 비트로 표현한다. 빠르게 처리되지만 공간 낭비 우려가있음.
- 가변폭(비모달): 다른 문자 코드 번호에 다른 길이의 비트를 사용함. 자주 사용하는 글자의 비트 길이를 줄일 수 있고, 국제 문자에 대해서는 여러 바이트를 사용하도록 함으로써 이전의 8비트 문자집합과의 호환성도 유지할 수 있음.
- 가변폭(모달): 모달 인코딩은 달나ㅡ 모드로의 전환을 위해 특별한 ‘escape’패턴을 사용함. 예를 들어 어떤 모달 인코딩은 텍스트에서 중첩된 여러가지 문자 집합간의 전환을 위해 사용될 수 있다. 모달 인코딩은 복잡하지만 복잡한 표기 체계를 효과적으로 지우넣재루 수 있다.
- 8비트: 8비트 고정폭 아이덴티티 인코딩은 간단히 각 문자코드를 그에 댛응하는 8비트값으로 인코딩한다. 256개의 문자의 코드 범위에 대한 문자집ㅎ팝만을 지원한다. iso-8859문자 집합군은 8비트 아이덴티티 인코딩을 사용한다.
- UTF-8: 가장 인기있는 UCS(UCS Transformation Format)를 위해 설계된 문자 인ㅋ됭. 문자 코드의 값을 위해 비모달 가변길이 인코딩을 사용한다.
- iso-2022-jp: 일본어 인터넷 문서를 위해 널리 사용되는 인코딩 8비트 문자를 지원하지 않는 소프트웨어와의 문제점을 방지하기 위해 128보다 작은 값으로만 이루어진 가변길이 모달 인코딩이다.
- euc-jp: 인기있는 일본어 인코딩. EUC는 ‘Extended Unix Code’의 약자로 유닉스 운영체제에서 아시아 문자들을 지원하기 위해 처음 개발됨.
- euc-kr: 한글 인터넷 문서를 위해 널리 사용되는 가변길이 인코딩
