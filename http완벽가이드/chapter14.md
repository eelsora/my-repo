# 14. 보안 HTTP

적대 행위가 일어날 가능성이 있는 커뮤니티에서 중요한 HTTP 트랜잭션을 보호하기 위해선 더 복잡하고 적극적인 기술이 있다.

## 14.1 HTTP를 안전하게 만들기

은행 업무, 보안자료 업로드 등의 중요한 일을 할 경우엔 안전한 HTTP 트랜잭션이 보장되어야한다.

- 서버인증: 클라이언트는 자신이 위조된 서버가 아닌 진짜와 이야고 있음을 알 수 있어야한다.
- 클라이언트 인증: 서버는 자신이 가짜가 아닌 진짜 사용자와 이야기하고 있음을 알 수 있어야한다.
- 무결성: 클라이언트와 서버는 그들의 데이터가 위조되는 것으로부터 안전해야한다.
- 암호화: 클라이언트와 서버는 도청에 대한 거정 없이 서로 대화할 수 있어야 한다.
- 효율: 저렴한 클라이언트나 서버도 이용할 수 있도록 알고리즘은 충분히 빨라야한다.
- 편재성(Ubiquity): 프로토콜은 거의 모든 클라이언트와 서버에서 지원되어야 한다.
- 관리상 확장성: 누구든 어디서든 즉각적인 보안 통신을 할 수 있어야한다.
- 적응성: 현재 알려진 최선의 보안 방법을 지원해야한다.
- 사회적 생존성: 사회의 문화적, 정치적 요구를 만족시켜야한다.

### 14.1.1 HTTPS

HTTPS는 HTTP를 안전하게 만드는 방식 중 가장 인기있는 방식이다.

HTTPS를 사용할 때, 모든 HTTP 요청과 응답 데이터는 네트워크로 보내지기 전에 암호화된다. HTTPS는 HTTP의 하부에 전송 레벨 암호 보안 계층을 제공함으로써 동작하는데, 이 보안계층은 **안전한 소켓 계층(Secure Sockets Layer, SSL)** 혹은 그를 계승한 **전송 계층 보안 (Transport Layer Security, TLS)**을 이용하여 구현된다.

어려운 인코딩, 디코딩 작업은 대부분 SSL 라이브러리 안에서 일어나기 때문에, 보안 HTTP를 사용하기 위해 웹 클라이언트와 서버가 프로토콜을 처리하는 로직을 크게 변경할 필요는 없다. 대부분의 경우 TCP 입력/출력 호출을 SSL 호출로 대체하고, 보안 정보를 설정하고 관리하기 위한 몇가지 호출을 추가하기만 하면 된다.

## 14.2 디지털 암호학

- 암호: 텍스트를 아무나 읽지 못하도록 인코딩하는 알고리즘
- 키: 암호의 동작을 변경하는 숫자로 된 매개변수
- 대칭키 암호 체계: 인코딩과 디코딩에 같은 키를 사용하는 알고리즘
- 비대칭키 암호 체계: 인코딩과 디코딩에 다른 키를 사용하는 알고리즘
- 공개키 암호법: 비밀 메시지를 전달하는 수백만대의 컴퓨터를 쉽게 만들 수 있는 시스템
- 디지털 서명: 메시지가 위조 혹은 변조되지 않았음을 증명하는 체크섬
- 디지털 인증서: 신뢰할만한 조직에 의해 서명되고 검증된 신원확인정보

### 14.2.1 비밀 코드의 기술과 과학

암호법(cyptography)은 메세지 인코딩과 디코딩에 대한 과학이자 기술이다.

암호법은 메세지를 암호화 하는것 뿐 아니라 메세지의 변조를 방지하기 위해 사용할 수도있다.

### 14.2.2 암호(cipher)

암호법은 암호라 불리는 비밀코드에 기반한다. 암호란 메세지를 인코딩하는 어떤 특정한 방법과 나중에 그 비밀메세지를 디코딩하는 방법이다. 인코딩되기 전의 원본 메세지는 흔히 텍스트 혹은 평문 이라고 불린다. 암호가 적용되어 코딩된 메세지는 보통 암호문이라고 불린다.

### 14.2.3 암호 기계

기술이 진보하면서 사람들은 보다 복잡한 암호로 메세지를 빠르고 정확하게 인코딩, 디코딩하는 기계를 만들어냈다.

### 14.2.4 키가 있는 암호

오늘날 거의 대부분의 암호알고리즘은 키를 사용한다. 암호키는 하나의 암호기계를 여러 가상 암호기계의 집합처럼 만들어준다. 하나의 인코더로 다른 키를 입력하면 각각 다른 암호문을 만들어 준다.

### 14.2.5 디지털 암호

디지털 계산의 도래로 발전된 두가지.

1. 속도 및 기능 제한에서 벗어나 복잡한 인코딩과 디코딩 알고리즘이 가능해짐
2. 매우 큰 키를 지원하는 것이 가능해져서, 단일 암호 알고리즘으로 키의 값마다 다른 수조개의 가상 알고리즘을 만들어낼 수 있게됨.

코딩 알고리즘은 데이터 덩어리를 받아서 알고리즘과 키의 값에 근거하여 인코딩 하거나 디코딩하는 함수이다.

## 14.3 대칭키 암호법

인코딩할 때 사용하는키가 디코딩할 때 사용하는 키와 같은것을 대칭키 암호라고 부른다.

잘 알려진 대칭키 암호 알고리즘으로는 DES, Triple-DES, RC2, RC4 등이 있다.

### 14.3.1 키 길이와 열거 동작(Enumeration Attack)

무차별적으로 모든 키 값을 대입해 보는 공격을 열거 공격이라고 한다.

키값의 크기가 클 수록 무차별 대입으로 암호를 실질적으로 깨트리기가 힘들다.

### 14.3.2 공유키 발급하기

대칭키 암호의 단점 중 하나는 발송자와 수신자가 서로 대화하려면 둘 다 공유키를 가져야한다는 것이다.

만약 N개의 노드가 있고 각 노드가 상대 N-1과 은밀하게 대화를 나눠야한다면 N의 2제곱 개의 비밀키가 필요하며, 이는 키를 관리하는 사람 입장에서는 지옥이다.

## 14.4 공개키 암호법

한 쌍의 호스트가 하나의 인코딩/디코딩 키를 사용하는 대신, 공개키 암호 방식은 두 개의 비대칭 키를 사용한다.

하나는 호스트 메세지를 인코딩하고, 다른 하나는 그 호스트의 메시지를 디코딩하기 위해 사용된다. 인코딩 키는 모두를 위해 공개되어있다.(\*그래서 공개키 암호화 방식이라고도 한다). 하지만 호스트만이 개인 디코딩 키를 알고있다.
